<!DOCTYPE html>
<html>
<head>
    <meta charset="utf8">
    <title>SydJS playground</title>
    <style>
        body {
            background: url(../common/img/blueprintbg.png);
        }
        .experiment {
            border: 1px dashed white;
            padding: 20px;
        }
        #clock input {
            display: block;
        }
    </style>
</head>
<body>
    <script src="../common/js/raphael.js"></script>

    <div id="clock" class="experiment">
        <input type="range" id="clock-time" min="0" max="1" step="0.01" value="0">
    </div>
    <script>
        (function () {
            var clock = {
                paper: Raphael('clock', 70, 70),
                parts: {},
                setTime: function (t) {
                    t > 1 && (t /= 100);
                    this.time = t;
                    this.draw();
                },
                draw: function () {
                    // Reference
                    // this.paper.path("M16,1.466C7.973,1.466,1.466,7.973,1.466,16c0,8.027,6.507,14.534,14.534,14.534c8.027,0,14.534-6.507,14.534-14.534C30.534,7.973,24.027,1.466,16,1.466zM16,27.533C9.639,27.533,4.466,22.359,4.466,16C4.466,9.64,9.639,4.466,16,4.466c6.361,0,11.533,5.173,11.533,11.534C27.533,22.361,22.359,27.533,16,27.533zM15.999,5.125c-0.553,0-0.999,0.448-0.999,1v9.221L8.954,17.99c-0.506,0.222-0.736,0.812-0.514,1.318c0.164,0.375,0.53,0.599,0.915,0.599c0.134,0,0.271-0.027,0.401-0.085l6.626-2.898c0.005-0.002,0.009-0.004,0.013-0.006l0.004-0.002c0.015-0.006,0.023-0.02,0.037-0.025c0.104-0.052,0.201-0.113,0.279-0.195c0.034-0.034,0.053-0.078,0.079-0.117c0.048-0.064,0.101-0.127,0.13-0.204c0.024-0.06,0.026-0.125,0.038-0.189C16.975,16.121,17,16.064,17,15.999V6.124C17,5.573,16.552,5.125,15.999,5.125z")
                    //     .attr({
                    //         fill: "#fff",
                    //         stroke: "none",
                    //         transform: "t16,16 s2"
                    //     })

                    var bigRotation = 360 * this.time;
                    var smallRotation = 30 * this.time + 330;
                    var handDiff = bigRotation + (360 - smallRotation);
                    var curvePath = 'M32,9 a23,23,0,1,1,0,46 a23,23,0,1,1,0,-46';
                    var curvePathLength = Raphael.getTotalLength(curvePath);
                    var subPath = Raphael.getSubpath(curvePath, 0, (handDiff / 360) * curvePathLength);
                    var path = subPath + ' L32,32 z';
                    // var endY = Math.sin(handDiffRad) * 23 + 23;
                    // var endX = Math.cos(handDiffRad) * 23;

                    this.parts.fill.attr({
                        // path: Raphael.format(path, endX, endY),
                        path: path,
                        fill: 'hsl(225deg, .7, .65)',
                        'fill-opacity': this.time,
                        transform: 'r' + smallRotation + ',32,32'
                    });
                    this.parts.bigHand.transform('t32,32r' + bigRotation + ',0,0');
                    this.parts.smallHand.transform('t32,32r' + smallRotation + ',0,0');
                },
                init: function () {
                    this.parts.circle = this.paper.circle(32, 32, 26).attr({
                        stroke: '#fff',
                        'stroke-width': 6
                    });
                    this.parts.fill = this.paper.path().attr({stroke: 0});
                    this.parts.bigHand = this.paper.path('M2,0 a2,2,0,0,1,-4,0 l1,-20,1,-2,1,2 z').attr({
                        fill: '#fff',
                        stroke: 0,
                        transform: 't32,32'
                    });
                    this.parts.smallHand = this.paper.path('M2,0 a2,2,0,0,1,-4,0 l1,-15,1,-2,1,2 z').attr({
                        fill: '#fff',
                        stroke: 0,
                        transform: 't32,32'
                    });
                    this.time = 0;
                    this.draw();
                }
            };
            clock.init();

            var input = document.getElementById('clock-time');
            input.addEventListener('change', function () {
                clock.setTime(+input.value);
            }, false);
        })();
    </script>
</body>
</html>