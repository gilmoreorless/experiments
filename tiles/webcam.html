<!DOCTYPE html>
<html>
<head>
    <title>Image tiles / Webcam</title>
</head>
<body>
    <canvas id="game"></canvas>
    <video id="webcam" autoplay></video>
    <canvas id="source" width="640" height="480"></canvas>
    <script src="../common/js/gumShield.js"></script>
    <script src="js/tilegame.js"></script>
    <script>
        var tiler = new Tiler('game', {
            width: 640,
            height: 480,
            rows: 4,
            cols: 4
        });
        var video = document.getElementById('webcam');
        var source = document.getElementById('source');
        var ctx = source.getContext('2d');
        // Only works in Opera Labs right now
        navigator.getUserMedia({video: true}, function (stream) {
            video.src = getStreamSrc(stream);
            ctx.translate(640, 0);
            ctx.scale(-1, 1);
            setInterval(function () {
                ctx.drawImage(video, 0, 0);
                tiler.setSrc(source);
            }, 1000 / 24);
        }, function () {
            console.error('Oh noes!');
        });
    </script>
</body>
</html>